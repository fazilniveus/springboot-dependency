steps:
  - name: 'gcr.io/cloud-builders/docker'
    args: 
    - 'build'
    - '--build-arg'
    - 'SONARQUBE_SCANNER_CLI_VERSION=3.2.0.1227'
    - '-t'
    - 'gcr.io/$PROJECT_ID/sonar-scanner:latest'
    - '-t'
    - 'gcr.io/$PROJECT_ID/sonar-scanner:3.2.0.1227'
    - '.'

  - name: 'gcr.io/cloud-builders/mvn'
    args: ['install']
  - name: 'gcr.io/$PROJECT_ID/sonar-scanner:latest'
    args:
    - '-Dsonar.host.url=http://34.93.141.200:9000'
    - '-Dsonar.login=e0a95d4b25ed8ad54f8906bc5e0f6e486b7fbeb2'
    - '-Dsonar.projectKey=sonar-jenkins'
    - '-Dsonar.sources=.'
tags: ['cloud-builders-community']

images: 
- 'gcr.io/$PROJECT_ID/sonar-scanner:latest'
- 'gcr.io/$PROJECT_ID/sonar-scanner:3.2.0.1227'
